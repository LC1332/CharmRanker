# æ£€æµ‹ç»“æœäº¤äº’å¼å¯è§†åŒ–

è¿™ä¸ªæ¨¡å—æä¾›äº†ä¸€ä¸ªäº¤äº’å¼ Web ç•Œé¢ï¼Œç”¨äºä¸€å¼ ä¸€å¼ æŸ¥çœ‹æ£€æµ‹ç»“æœã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- ğŸ–¼ï¸ é€å¼ æŸ¥çœ‹æ£€æµ‹ç»“æœå›¾ç‰‡
- ğŸ¨ ç”¨ä¸åŒé¢œè‰²åŒºåˆ†äººè„¸æ¡†ï¼ˆé’è‰²ï¼‰å’Œäººä½“æ¡†ï¼ˆæ©™è‰²ï¼‰
- ğŸ”˜ å¯åˆ‡æ¢æ˜¾ç¤º/éšè—äººè„¸æ¡†ã€äººä½“æ¡†ã€å…³é”®ç‚¹
- âŒ¨ï¸ æ”¯æŒé”®ç›˜å¿«æ·é”®å¯¼èˆª
- ğŸ“Š å®æ—¶æ˜¾ç¤ºæ£€æµ‹ç½®ä¿¡åº¦å’Œè¾¹ç•Œæ¡†ä¿¡æ¯

## ä½¿ç”¨æ–¹æ³•

### 1. å®‰è£…ä¾èµ–

```bash
pip install flask
```

### 2. è¿è¡Œå¯è§†åŒ–æœåŠ¡

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
cd /path/to/CharmRanker
python -m src.detect_vis.app --folder Album_A --port 5000
```

æˆ–è€…ç›´æ¥è¿è¡Œï¼š

```bash
cd src/detect_vis
python app.py --folder Album_A --port 5000
```

### 3. æ‰“å¼€æµè§ˆå™¨

è®¿é—® http://127.0.0.1:5000 å³å¯æŸ¥çœ‹å¯è§†åŒ–ç•Œé¢ã€‚

## å‘½ä»¤è¡Œå‚æ•°

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `--folder` | ç›®æ ‡æ–‡ä»¶å¤¹åç§° | `Album_A` |
| `--port` | æœåŠ¡ç«¯å£ | `5000` |
| `--host` | æœåŠ¡ä¸»æœºåœ°å€ | `127.0.0.1` |

## å¿«æ·é”®

| å¿«æ·é”® | åŠŸèƒ½ |
|--------|------|
| `â†` / `â†’` | ä¸Šä¸€å¼  / ä¸‹ä¸€å¼  |
| `Home` / `End` | ç¬¬ä¸€å¼  / æœ€åä¸€å¼  |
| `F` | åˆ‡æ¢äººè„¸æ¡†æ˜¾ç¤º |
| `B` | åˆ‡æ¢äººä½“æ¡†æ˜¾ç¤º |
| `K` | åˆ‡æ¢å…³é”®ç‚¹æ˜¾ç¤º |

## æ–‡ä»¶ç»“æ„

```
src/detect_vis/
â”œâ”€â”€ app.py              # Flask åç«¯åº”ç”¨
â”œâ”€â”€ readme.md           # æœ¬è¯´æ˜æ–‡ä»¶
â””â”€â”€ templates/
    â””â”€â”€ viewer.html     # å‰ç«¯é¡µé¢æ¨¡æ¿
```

## æ•°æ®æ ¼å¼

ç¨‹åºä¼šè¯»å– `local_data/{folder}_detect_result.jsonl` æ–‡ä»¶ï¼Œæ¯è¡Œæ˜¯ä¸€ä¸ª JSON å¯¹è±¡ï¼š

```json
{
    "image_path": "Album_A/A/xxx/xxx.jpg",
    "image_width": 600,
    "image_height": 450,
    "face_bbox": {"x_min": 0.27, "y_min": 0.17, "width": 0.14, "height": 0.19},
    "face_confidence": 0.72,
    "face_keypoints": {...},
    "body_bbox": {"x_min": 0.18, "y_min": 0.17, "width": 0.31, "height": 0.82},
    "body_confidence": 0.97
}
```
